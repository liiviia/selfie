{"ast":null,"code":"import { createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, vModelSelect as _vModelSelect, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, vModelCheckbox as _vModelCheckbox, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode, withModifiers as _withModifiers } from \"vue\";\nconst _hoisted_1 = {\n  class: \"note-container\"\n};\nconst _hoisted_2 = {\n  class: \"form-group\"\n};\nconst _hoisted_3 = {\n  class: \"form-group\"\n};\nconst _hoisted_4 = {\n  class: \"form-group\"\n};\nconst _hoisted_5 = {\n  key: 0,\n  class: \"form-group\"\n};\nconst _hoisted_6 = [\"value\", \"id\"];\nconst _hoisted_7 = [\"for\"];\nconst _hoisted_8 = {\n  class: \"notes-list\"\n};\nconst _hoisted_9 = [\"innerHTML\"];\nconst _hoisted_10 = {\n  key: 0\n};\nconst _hoisted_11 = {\n  class: \"note-actions\"\n};\nconst _hoisted_12 = [\"onClick\"];\nconst _hoisted_13 = [\"onClick\"];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_cache[11] || (_cache[11] = _createElementVNode(\"h1\", null, \"Aggiungi una Nota\", -1)), _createElementVNode(\"form\", {\n    onSubmit: _cache[4] || (_cache[4] = _withModifiers((...args) => $options.addNote && $options.addNote(...args), [\"prevent\"])),\n    class: \"note-form\"\n  }, [_createElementVNode(\"div\", _hoisted_2, [_cache[5] || (_cache[5] = _createElementVNode(\"label\", {\n    for: \"heading\"\n  }, \"Titolo:\", -1)), _withDirectives(_createElementVNode(\"input\", {\n    type: \"text\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.newNote.heading = $event),\n    id: \"heading\",\n    required: \"true\",\n    class: \"form-input\"\n  }, null, 512), [[_vModelText, $data.newNote.heading]])]), _createElementVNode(\"div\", _hoisted_3, [_cache[6] || (_cache[6] = _createElementVNode(\"label\", {\n    for: \"content\"\n  }, \"Contenuto(possibile scrivere in markdwon):\", -1)), _withDirectives(_createElementVNode(\"textarea\", {\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $data.newNote.content = $event),\n    id: \"content\",\n    rows: \"4\",\n    class: \"form-textarea\",\n    required: \"true\"\n  }, null, 512), [[_vModelText, $data.newNote.content]])]), _createElementVNode(\"div\", _hoisted_4, [_cache[8] || (_cache[8] = _createElementVNode(\"label\", {\n    for: \"access\"\n  }, \"Livello di Accesso:\", -1)), _withDirectives(_createElementVNode(\"select\", {\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $data.newNote.access = $event),\n    id: \"access\",\n    class: \"form-input\"\n  }, _cache[7] || (_cache[7] = [_createElementVNode(\"option\", {\n    value: \"public\"\n  }, \"Pubblico\", -1), _createElementVNode(\"option\", {\n    value: \"private\"\n  }, \"Privato\", -1), _createElementVNode(\"option\", {\n    value: \"restricted\"\n  }, \"Riservato\", -1)]), 512), [[_vModelSelect, $data.newNote.access]])]), $data.newNote.access === 'restricted' ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [_cache[9] || (_cache[9] = _createElementVNode(\"label\", null, \"Utenti Autorizzati:\", -1)), (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($options.filteredUsers, user => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: user._id,\n      class: \"form-check\"\n    }, [_withDirectives(_createElementVNode(\"input\", {\n      class: \"form-check-input\",\n      type: \"checkbox\",\n      value: user.username,\n      id: user._id,\n      \"onUpdate:modelValue\": _cache[3] || (_cache[3] = $event => $data.newNote.allowedUsers = $event)\n    }, null, 8, _hoisted_6), [[_vModelCheckbox, $data.newNote.allowedUsers]]), _createElementVNode(\"label\", {\n      class: \"form-check-label\",\n      for: user._id\n    }, _toDisplayString(user.username), 9, _hoisted_7)]);\n  }), 128))])) : _createCommentVNode(\"\", true), _cache[10] || (_cache[10] = _createElementVNode(\"button\", {\n    type: \"submit\",\n    class: \"submit-button\"\n  }, \"Aggiungi Nota\", -1))], 32), _cache[12] || (_cache[12] = _createElementVNode(\"h1\", null, \"Note\", -1)), _createElementVNode(\"ul\", _hoisted_8, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.notes, note => {\n    return _openBlock(), _createElementBlock(\"li\", {\n      key: note._id,\n      class: \"note-item\"\n    }, [_createElementVNode(\"h2\", null, _toDisplayString(note.heading), 1), _createElementVNode(\"div\", {\n      class: \"note-content\",\n      innerHTML: $options.renderMarkdown(note.content)\n    }, null, 8, _hoisted_9), _createElementVNode(\"p\", null, \"Autore: \" + _toDisplayString(note.author), 1), (note.access === 'public' || note.access === 'restricted' && note.allowedUsers && note.allowedUsers.includes($data.username)) && note.author !== $data.username ? (_openBlock(), _createElementBlock(\"p\", _hoisted_10, \" Condivisa con te da: \" + _toDisplayString(note.author), 1)) : _createCommentVNode(\"\", true), _createElementVNode(\"div\", _hoisted_11, [_createElementVNode(\"button\", {\n      onClick: $event => $options.editNote(note._id),\n      class: \"edit-btn\"\n    }, \"Modifica\", 8, _hoisted_12), _createElementVNode(\"button\", {\n      onClick: $event => $options.deleteNote(note._id),\n      class: \"delete-btn\"\n    }, \"Elimina\", 8, _hoisted_13)])]);\n  }), 128))])]);\n}","map":{"version":3,"names":["class","key","_createElementBlock","_hoisted_1","_createElementVNode","onSubmit","_cache","_withModifiers","args","$options","addNote","_hoisted_2","for","type","$event","$data","newNote","heading","id","required","_hoisted_3","content","rows","_hoisted_4","access","value","_hoisted_5","_Fragment","_renderList","filteredUsers","user","_id","username","allowedUsers","_hoisted_6","_hoisted_7","_createCommentVNode","_hoisted_8","notes","note","_toDisplayString","innerHTML","renderMarkdown","_hoisted_9","author","includes","_hoisted_10","_hoisted_11","onClick","editNote","_hoisted_12","deleteNote","_hoisted_13"],"sources":["/home/massi1/Documenti/uni/tecWEB/progettoClone/progettoTWvue/frontend/src/views/ToDoApp.vue"],"sourcesContent":["<template>\n  <div class=\"note-container\">\n    <h1>Aggiungi una Nota</h1>\n    <form @submit.prevent=\"addNote\" class=\"note-form\">\n      <div class=\"form-group\">\n        <label for=\"heading\">Titolo:</label>\n        <input type=\"text\" v-model=\"newNote.heading\" id=\"heading\" required=\"true\" class=\"form-input\" />\n      </div>\n      <div class=\"form-group\">\n        <label for=\"content\">Contenuto(possibile scrivere in markdwon):</label>\n        <textarea v-model=\"newNote.content\" id=\"content\" rows=\"4\" class=\"form-textarea\" required=\"true\"></textarea>\n      </div>\n\n      <div class=\"form-group\">\n        <label for=\"access\">Livello di Accesso:</label>\n        <select v-model=\"newNote.access\" id=\"access\" class=\"form-input\">\n          <option value=\"public\">Pubblico</option>\n          <option value=\"private\">Privato</option>\n          <option value=\"restricted\">Riservato</option>\n        </select>\n      </div>\n\n      <div class=\"form-group\" v-if=\"newNote.access === 'restricted'\">\n        <label>Utenti Autorizzati:</label>\n        <div v-for=\"user in filteredUsers\" :key=\"user._id\" class=\"form-check\">\n          <input \n            class=\"form-check-input\" \n            type=\"checkbox\" \n            :value=\"user.username\" \n            :id=\"user._id\" \n            v-model=\"newNote.allowedUsers\" \n          />\n          <label class=\"form-check-label\" :for=\"user._id\">\n            {{ user.username }} \n          </label>\n        </div>\n      </div>\n\n      <button type=\"submit\" class=\"submit-button\">Aggiungi Nota</button>\n    </form>\n\n    <h1>Note</h1>\n    <ul class=\"notes-list\">\n      <li v-for=\"note in notes\" :key=\"note._id\" class=\"note-item\">\n        <h2>{{ note.heading }}</h2>\n        <div class=\"note-content\" v-html=\"renderMarkdown(note.content)\"></div>\n        <p>Autore: {{ note.author }}</p>\n        <p v-if=\"(note.access === 'public' || (note.access === 'restricted' && note.allowedUsers && note.allowedUsers.includes(username))) && note.author !== username\">\n           Condivisa con te da: {{ note.author }}\n        </p>\n\n        <div class=\"note-actions\">\n          <button @click=\"editNote(note._id)\" class=\"edit-btn\">Modifica</button>\n          <button @click=\"deleteNote(note._id)\" class=\"delete-btn\">Elimina</button>\n        </div>\n      </li>\n    </ul>\n  </div>\n</template>\n\n\n<script>\nimport axios from 'axios';\nimport { marked } from 'marked';\n\nexport default {\n  data() {\n    return {\n      newNote: {\n        heading: '',\n        access: 'private',\n        allowedUsers: [],\n        content: ''\n      },\n      allUsers: [],\n      notes: [],\n      username: '' \n    };\n  },\n\n  computed: {\n    filteredUsers() {\n      return this.allUsers.filter(user => user.username !== this.username); \n    }\n  },\n\n  async created() {\n\n    this.username = localStorage.getItem('username'); \n\n    await this.fetchNotes();\n    await this.fetchUsers(); \n  },\n  \n  methods: {\n    async fetchNotes() {\n      try {\n        const token = sessionStorage.getItem('token');\n        if (!this.username) {\n          console.error('Username non trovato');\n          return;\n        }\n        const response = await axios.get('/api/notesGET', {\n          params: { username: this.username },\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        this.notes = response.data;\n      } catch (error) {\n        console.error('Errore nel recupero delle note:', error);\n      }\n    },\n    \n    async addNote() {\n      try {\n        const token = sessionStorage.getItem('token');\n        if (!this.username) {\n          console.error('Username non trovato, impossibile creare la nota');\n          return;\n        }\n        this.newNote.author = this.username;\n\n        const response = await axios.post('/api/notes', this.newNote, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        console.log('Nota aggiunta:', response.data);\n\n        this.newNote = { heading: '', content: '', access: 'private', allowedUsers: [] };\n        this.fetchNotes();\n      } catch (error) {\n        console.error(\"Errore nell'aggiunta della nota:\", error);\n      }\n    },\n\n    editNote(id) {\n      this.$router.push(`/edit-note/${id}`);\n    },\n\n    async deleteNote(id) {\n  try {\n    const token = sessionStorage.getItem('token');\n    const username = localStorage.getItem('username');\n    \n    await axios.delete(`/api/notesRIM/${id}`, {\n      headers: {\n        Authorization: `Bearer ${token}`\n      },\n      data: {\n        username: username \n      }\n    });\n\n    this.fetchNotes();\n  } catch (error) {\n    if (error.response && error.response.status === 403) {\n      alert('Non autorizzato a eliminare la nota');\n    } else {\n      console.error(\"Errore nell'eliminazione della nota:\", error);\n    }\n  }\n},\n\n\n    async fetchUsers() {\n      try {\n        const token = sessionStorage.getItem('token');\n        const response = await axios.get('/api/users', {\n          headers: { Authorization: `Bearer ${token}` }\n        });\n        this.allUsers = response.data;\n      } catch (error) {\n        console.error('Errore nel recupero degli utenti:', error);\n      }\n    },\n\n    renderMarkdown(content) {\n      if (!content) return '';\n      return marked(content);\n    }\n  }\n};\n\n</script>\n\n<style scoped>\n.note-container {\n  max-width: 600px;\n  margin: 50px auto;\n  padding: 30px;\n  background-color: #15172b;\n  border-radius: 12px;\n  box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);\n  transition: transform 0.3s ease;\n  box-sizing: border-box;\n}\n\n.note-container:hover {\n  transform: translateY(-5px);\n}\n\nh1 {\n  text-align: center;\n  margin-bottom: 30px;\n  color: #acb0b4;\n  font-family: 'Poppins', sans-serif;\n  font-size: 28px;\n}\n\n.form-group {\n  margin-bottom: 20px;\n}\n\nlabel {\n  font-weight: bold;\n  margin-bottom: 8px;\n  color: #acb0b4;\n  font-family: 'Poppins', sans-serif;\n  display: block;\n}\n\n.form-input, .form-textarea {\n  padding: 12px;\n  border: 2px solid #ced4da;\n  border-radius: 8px;\n  font-size: 16px;\n  width: 100%;\n  transition: border-color 0.3s ease, box-shadow 0.3s ease;\n  background-color: #f3f4f6;\n}\n\n.form-input:focus, .form-textarea:focus {\n  border-color: #007bff;\n  box-shadow: 0 0 8px rgba(0, 123, 255, 0.25);\n  outline: none;\n}\n\n.form-textarea {\n  height: 120px;\n  resize: none;\n}\n\n.submit-button {\n  padding: 12px;\n  background-color: #007bff;\n  color: white;\n  border: none;\n  border-radius: 8px;\n  cursor: pointer;\n  font-size: 18px;\n  font-family: 'Poppins', sans-serif;\n  transition: background-color 0.3s ease, transform 0.2s;\n}\n\n.submit-button:hover {\n  background-color: #0056b3;\n  transform: translateY(-2px);\n}\n\n.notes-list {\n  list-style-type: none;\n  padding: 0;\n  width: 100%;\n  max-width: 600px;\n  margin-top: 20px;\n}\n\n.note-item {\n  background-color: #ffffff;\n  border-radius: 12px;\n  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);\n  padding: 20px;\n  margin-bottom: 20px;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  width: 100%;\n}\n\n.note-content {\n  margin-bottom: 15px;\n  line-height: 1.6;\n  color: #333;\n  width: 100%;\n  text-align: left;\n}\n\n.note-actions {\n  display: flex;\n  justify-content: center;\n  margin-top: 10px;\n}\n\n.note-actions button {\n  background-color: #007bff;\n  color: white;\n  border: none;\n  padding: 10px 15px;\n  border-radius: 6px;\n  cursor: pointer;\n  font-size: 14px;\n  margin: 0 5px;\n  transition: background-color 0.3s;\n}\n\n.note-actions .edit-btn:hover {\n  background-color: #0056b3;\n}\n\n.note-actions .delete-btn {\n  background-color: #dc3545;\n}\n\n.note-actions .delete-btn:hover {\n  background-color: #c82333;\n}\n\n.status-message {\n  text-align: center;\n  margin-top: 20px;\n  color: #28a745;\n  font-family: 'Poppins', sans-serif;\n  font-size: 16px;\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}