{"ast":null,"code":"import { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createTextVNode as _createTextVNode } from \"vue\";\nconst _hoisted_1 = {\n  class: \"event-list\"\n};\nconst _hoisted_2 = [\"onClick\"];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_cache[6] || (_cache[6] = _createElementVNode(\"h1\", null, \"Lista Eventi\", -1 /* HOISTED */)), _createElementVNode(\"h2\", null, \"Numero Eventi: \" + _toDisplayString($data.events.length), 1 /* TEXT */), _createElementVNode(\"ul\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.events, event => {\n    return _openBlock(), _createElementBlock(\"li\", {\n      key: event._id,\n      class: \"event-item\"\n    }, [_createElementVNode(\"h2\", null, _toDisplayString(event.title), 1 /* TEXT */), _createElementVNode(\"p\", null, _toDisplayString(event.description), 1 /* TEXT */), _createElementVNode(\"p\", null, [_cache[0] || (_cache[0] = _createElementVNode(\"strong\", null, \"Data:\", -1 /* HOISTED */)), _createTextVNode(\" \" + _toDisplayString($options.formatDate(event.date)), 1 /* TEXT */)]), _createElementVNode(\"p\", null, [_cache[1] || (_cache[1] = _createElementVNode(\"strong\", null, \"Orario:\", -1 /* HOISTED */)), _createTextVNode(\" \" + _toDisplayString(event.time), 1 /* TEXT */)]), _createElementVNode(\"p\", null, [_cache[2] || (_cache[2] = _createElementVNode(\"strong\", null, \"Durata:\", -1 /* HOISTED */)), _createTextVNode(\" \" + _toDisplayString(event.duration) + \" minuti\", 1 /* TEXT */)]), _createElementVNode(\"p\", null, [_cache[3] || (_cache[3] = _createElementVNode(\"strong\", null, \"Luogo:\", -1 /* HOISTED */)), _createTextVNode(\" \" + _toDisplayString(event.location), 1 /* TEXT */)]), _createElementVNode(\"p\", null, [_cache[4] || (_cache[4] = _createElementVNode(\"strong\", null, \"Ripetizione:\", -1 /* HOISTED */)), _createTextVNode(\" \" + _toDisplayString($options.formatRepeat(event)), 1 /* TEXT */)]), _createElementVNode(\"p\", null, [_cache[5] || (_cache[5] = _createElementVNode(\"strong\", null, \"Autore:\", -1 /* HOISTED */)), _createTextVNode(\" \" + _toDisplayString(event.author), 1 /* TEXT */)]), _createElementVNode(\"button\", {\n      onClick: $event => $options.confirmDelete(event._id),\n      class: \"delete-btn\"\n    }, \"üóëÔ∏è\", 8 /* PROPS */, _hoisted_2)]);\n  }), 128 /* KEYED_FRAGMENT */))])]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createElementVNode","_toDisplayString","$data","events","length","_Fragment","_renderList","event","key","_id","title","description","_createTextVNode","$options","formatDate","date","time","duration","location","formatRepeat","author","onClick","$event","confirmDelete","_hoisted_2"],"sources":["/home/massi1/Documenti/uni/tecWEB/progettoClone/progettoTWvue/frontend/src/views/eventsE.vue"],"sourcesContent":["<template>\n  <div class=\"event-list\">\n    <h1>Lista Eventi</h1>\n    <h2>Numero Eventi: {{ events.length }}</h2>\n    <ul>\n      <li v-for=\"event in events\" :key=\"event._id\" class=\"event-item\">\n        <h2>{{ event.title }}</h2>\n        <p>{{ event.description }}</p>\n        <p><strong>Data:</strong> {{ formatDate(event.date) }}</p>\n        <p><strong>Orario:</strong> {{ event.time }}</p>\n        <p><strong>Durata:</strong> {{ event.duration }} minuti</p>\n        <p><strong>Luogo:</strong> {{ event.location }}</p>\n        <p><strong>Ripetizione:</strong> {{ formatRepeat(event) }}</p>\n        <p><strong>Autore:</strong> {{ event.author }}</p>\n        <button @click=\"confirmDelete(event._id)\" class=\"delete-btn\">üóëÔ∏è</button>\n      </li>\n    </ul>\n  </div>\n</template>\n\n<script>\nimport axios from 'axios';\n//import { EventBus } from '@/EventBus'; \n\nexport default {\n  data() {\n    return {\n      events: [],\n      currentDate: new Date() \n    };\n  },\n  methods: {\n    confirmDelete(id) {\n      if (confirm(\"Sicuro di voler eliminare questo Evento?\")) {\n        this.deleteEvents(id); \n      }\n    },\n    \n    async deleteEvents(id) {\n      try {\n        const token = sessionStorage.getItem('token');\n        await axios.delete(`/api/eventsRemove/${id}`, {\n          headers: {\n            Authorization: `Bearer ${token}` \n          }\n        });\n        console.log('Evento eliminato');\n        this.fetchEvents(); \n      } catch (error) {\n        console.error('Errore nell\\'eliminazione di evento:', error);\n      }\n    },\n\n    async fetchEvents() {\n      try {\n        const token = sessionStorage.getItem('token');\n        const username = localStorage.getItem('username'); \n        const response = await axios.get('/api/eventsGET', {\n          headers: {\n            Authorization: `Bearer ${token}` \n          },\n          params: { author: username }\n        });\n        \n       this.events = response.data;\n      } catch (error) {\n        console.error('Errore nel recupero degli eventi:', error);\n      }\n    },\n    \n    formatDate(date) {\n      const d = new Date(date);\n      return d.toLocaleDateString();\n    },\n\n    formatRepeat(event) {\n      if (event.repeatFrequency) {\n        let frequencyDetails = `${event.repeatFrequency}`;\n        if (event.daysOfWeek && event.daysOfWeek.length) {\n          frequencyDetails += ` ogni ${event.daysOfWeek.join(', ')}`;\n        }\n        if (event.dayOfMonth) {\n          frequencyDetails += ` ogni ${event.dayOfMonth}¬∞ giorno del mese`;\n        }\n        if (event.repeatUntil) {\n          frequencyDetails += ` fino al ${this.formatDate(event.repeatUntil)}`;\n        }\n        return frequencyDetails;\n      }\n      return 'Nessuna ripetizione';\n    }\n  },\n  mounted() {\n    this.fetchEvents();\n\n      EventBus.on('timeMachineSet', (simulatedTime) => {\n      this.currentDate = simulatedTime;\n      this.fetchEvents(); \n    });\n\n     EventBus.on('timeMachineUpdate', (simulatedTime) => {\n      this.currentDate = simulatedTime;\n      this.fetchEvents(); \n    });\n\n    EventBus.on('timeMachineReset', () => {\n      this.currentDate = new Date();\n      this.fetchEvents();\n    });\n  },\n\n  beforeUnmount() {\n    EventBus.off('timeMachineSet');\n    EventBus.off('timeMachineUpdate');\n    EventBus.off('timeMachineReset');\n  }\n};\n</script>\n\n<style scoped>\n.event-list {\n  max-width: 800px;\n  margin: 20px auto;\n  padding: 20px;\n  background-color: #f8f9fa;\n  border-radius: 8px;\n  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);\n}\n\nh1 {\n  text-align: center;\n  margin-bottom: 20px;\n  color: #343a40;\n}\n\nul {\n  list-style-type: none;\n  padding: 0;\n}\n\n.event-item {\n  margin-bottom: 20px;\n  border-bottom: 1px solid #ccc;\n  padding-bottom: 10px;\n  padding-right: 40px; \n  position: relative; \n}\n\n.event-item h2 {\n  color: #007bff;\n  margin: 0;\n}\n\n.event-item p {\n  margin: 5px 0;\n}\n\n.delete-btn {\n  position: absolute;\n  right: 10px;\n  bottom: 10px;\n  background-color: transparent;\n  border: none;\n  cursor: pointer;\n  font-size: 24px;\n}\n\n.delete-btn:hover {\n  color: red;\n}\n</style>"],"mappings":";;EACOA,KAAK,EAAC;AAAY;mBADzB;;uBACEC,mBAAA,CAgBM,OAhBNC,UAgBM,G,0BAfJC,mBAAA,CAAqB,YAAjB,cAAY,sBAChBA,mBAAA,CAA2C,YAAvC,iBAAe,GAAAC,gBAAA,CAAGC,KAAA,CAAAC,MAAM,CAACC,MAAM,kBACnCJ,mBAAA,CAYK,c,kBAXHF,mBAAA,CAUKO,SAAA,QAfXC,WAAA,CAK0BJ,KAAA,CAAAC,MAAM,EAAfI,KAAK;yBAAhBT,mBAAA,CAUK;MAVwBU,GAAG,EAAED,KAAK,CAACE,GAAG;MAAEZ,KAAK,EAAC;QACjDG,mBAAA,CAA0B,YAAAC,gBAAA,CAAnBM,KAAK,CAACG,KAAK,kBAClBV,mBAAA,CAA8B,WAAAC,gBAAA,CAAxBM,KAAK,CAACI,WAAW,kBACvBX,mBAAA,CAA0D,Y,0BAAvDA,mBAAA,CAAsB,gBAAd,OAAK,sBARxBY,gBAAA,CAQiC,GAAC,GAAAX,gBAAA,CAAGY,QAAA,CAAAC,UAAU,CAACP,KAAK,CAACQ,IAAI,kB,GAClDf,mBAAA,CAAgD,Y,0BAA7CA,mBAAA,CAAwB,gBAAhB,SAAO,sBAT1BY,gBAAA,CASmC,GAAC,GAAAX,gBAAA,CAAGM,KAAK,CAACS,IAAI,iB,GACzChB,mBAAA,CAA2D,Y,0BAAxDA,mBAAA,CAAwB,gBAAhB,SAAO,sBAV1BY,gBAAA,CAUmC,GAAC,GAAAX,gBAAA,CAAGM,KAAK,CAACU,QAAQ,IAAG,SAAO,gB,GACvDjB,mBAAA,CAAmD,Y,0BAAhDA,mBAAA,CAAuB,gBAAf,QAAM,sBAXzBY,gBAAA,CAWkC,GAAC,GAAAX,gBAAA,CAAGM,KAAK,CAACW,QAAQ,iB,GAC5ClB,mBAAA,CAA8D,Y,0BAA3DA,mBAAA,CAA6B,gBAArB,cAAY,sBAZ/BY,gBAAA,CAYwC,GAAC,GAAAX,gBAAA,CAAGY,QAAA,CAAAM,YAAY,CAACZ,KAAK,kB,GACtDP,mBAAA,CAAkD,Y,0BAA/CA,mBAAA,CAAwB,gBAAhB,SAAO,sBAb1BY,gBAAA,CAamC,GAAC,GAAAX,gBAAA,CAAGM,KAAK,CAACa,MAAM,iB,GAC3CpB,mBAAA,CAAyE;MAAhEqB,OAAK,EAAAC,MAAA,IAAET,QAAA,CAAAU,aAAa,CAAChB,KAAK,CAACE,GAAG;MAAGZ,KAAK,EAAC;OAAa,KAAG,iBAdxE2B,UAAA,E","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}